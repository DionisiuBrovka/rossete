from groq import Groq


def make_promt_lec(topic, h, discipline):
    return f"""Ты — опытный преподаватель колледжа. 
Твоя задача — подготовить подробный, структурированный конспект лекции для учебно-методического комплекса (УМК).

Дано:
- Тема: "{topic}"
- Количество академических часов: {h}
- Формат вывода: Markdown (.md), с учетом синтаксиса Obsidian.
- Целевая аудитория: студенты колледжа, изучающие дисциплину "{discipline}" на уровне среднего специального образования.
- Цель лекции: раскрыть основные теоретические понятия и дать практические примеры по теме.

Требования к структуре:
1. **Название лекции** — заголовок первого уровня.
2. **Цели и задачи** лекции — кратко (2–4 пункта).
3. **Ключевые понятия** — 5–10 терминов с короткими определениями.
4. **Основное содержание** — детальный материал, структурированный по смысловым разделам (подзаголовки 2–3 уровня).
5. **Примеры и иллюстрации** — простые, понятные коды, схемы или описания (в Markdown-блоках кода, если уместно).
6. **Выводы по лекции** — краткое резюме основных идей.
7. **Вопросы для самопроверки** — 5–10 вопросов для закрепления.
8. **Рекомендуемая литература / источники** — список из 3–5 источников.

Особенности генерации:
- Стиль изложения — академический, понятный и логичный.
- Каждый раздел основного раздела должен быть помечен количеством минут на изучения.
- Лекция на 1 час должна быть расчитана на 45 минут, на 2 - 90 мин.
- Код и примеры должны соответствовать языку и теме.
- Не использовать ссылки на внешние сайты, только упоминания источников (книги, стандарты, учебные пособия).
- Все заголовки должны использовать корректный синтаксис Markdown для Obsidian.
- Не используй смайлики и подчеркивания (---)

!!! Верни только готовый текст в формате Markdown без пояснений !!!
"""

def make_promt_lab_n_prac(topic, h, discipline, work_type):
    return f"""Ты — опытный преподаватель колледжа по дисциплине "{discipline}".  
Твоя задача — подготовить структурированный и методически корректный материал для учебно-методического комплекса (УМК).

Дано:
- Тип работы: {work_type}  (возможные значения: "лабораторная работа" или "практическая работа")
- Тема: "{topic}"
- Количество академических часов: {h}
- Формат вывода: Markdown (.md), совместимый с Obsidian.
- Целевая аудитория: студенты колледжа, изучающие дисциплину "{discipline}" на уровне среднего специального образования.

---

## Требования к структуре

1. **Название работы** — заголовок первого уровня.
2. **Цель и задачи** — 2–4 пункта, описывающие цели выполнения и ожидаемые навыки.
3. **Теоретическая часть** — краткое изложение основных понятий, необходимых для выполнения работы (5–10 ключевых определений и формул, если применимо).
4. **Ход выполнения работы**
   - Разбей процесс выполнения на шаги (нумерованный список).
   - Каждый шаг должен включать пояснение, пример и, если нужно, блок кода.
   - Примеры кода должны быть актуальны для выбранного языка/темы.
5. **Контрольные вопросы / задания для самопроверки** — 5–10 вопросов или упражнений.
6. **Отчёт по работе** — описание того, что должен содержать отчёт студента (структура, что приложить, какие выводы сделать).
7. **Критерии оценки** — кратко (3–5 пунктов).
8. **Рекомендуемая литература / источники** — список из 3–5 источников (учебники, ГОСТы, стандарты, но без ссылок на сайты).

---

## Особенности генерации

- Стиль изложения — академичный, методически корректный и понятный студентам.
- Материал должен соответствовать указанному количеству часов:
  - 1 час = ~45 минут (лабораторные и практические обычно 1–2 часа).
- Используй корректные заголовки Markdown (`#`, `##`, `###`).
- Для блоков кода используй тройные кавычки и указывай язык.
- Не добавляй лишние пояснения, комментарии или эмодзи.
- Если работа лабораторная — добавь акцент на экспериментальную часть и анализ результатов.
- Если работа практическая — сделай акцент на решении прикладных задач и отработке навыков.

---

Верни только готовый текст в формате Markdown, без пояснений и комментариев.
"""


def make_promt_okr(topic, h, discipline):
    return f"""
Ты — опытный преподаватель колледжа.  
Твоя задача — подготовить структурированный материал для **обязательной контрольной работы** в составе учебно-методического комплекса (УМК).

Дано:
- Тема: "{topic}"
- Количество академических часов: {h}
- Формат вывода: Markdown (.md), с учетом синтаксиса Obsidian.
- Целевая аудитория: студенты колледжа, изучающие дисциплину "{discipline}" на уровне среднего специального образования.
- Тип работы: Контрольная работа (обязательная).
- Цель: проверить усвоение студентами теоретических и практических знаний по теме.

Требования к структуре:
1. **Название контрольной работы** — заголовок первого уровня.  
2. **Цель и задачи контрольной работы** — кратко (2–4 пункта).
3. **Краткое теоретическое введение** — основные понятия и формулы, необходимые для выполнения заданий.
4. **Условия выполнения** — описание требований к оформлению, форме сдачи и критериям оценки (в виде маркированного списка).
5. **Варианты заданий** — не менее трёх вариантов, каждый оформлен под отдельным подзаголовком второго уровня:
   - Каждый вариант должен содержать **3–5 заданий разного типа**:  
     - теоретический вопрос;  
     - практическое (вычислительное или программное) задание;  
     - задание на анализ или проектирование (если применимо);  
     - задание с кодом (если дисциплина связана с программированием).  
   - У каждого задания должна быть **указана максимальная оценка (в баллах)**.
6. **Критерии оценивания** — таблица или маркированный список с распределением баллов (например, "Правильность выполнения — 5 б., оформление — 2 б.").
7. **Рекомендации для студента** — советы по подготовке (2–4 пункта).
8. **Пример решения (по одному заданию)** — демонстрация решения одного из заданий с пояснением (если тема позволяет).
9. **Время на выполнение** — {h}.
10. **Выводы** — краткое резюме знаний и умений, которые проверяются.

Особенности генерации:
- Стиль изложения — академический, чёткий, без воды.
- Все задания должны соответствовать теме и дисциплине.
- Формулировки заданий должны быть понятны студентам СПО.
- Код и примеры должны быть корректными и выполнены на языке, соответствующем дисциплине.
- Не использовать ссылки на внешние сайты; только упоминания печатных или учебных источников.
- Используй корректный Markdown-синтаксис для Obsidian.
- Не используй смайлики и горизонтальные линии (---).
- Если тема практическая — включай задания с кодом.
- Если тема теоретическая — делай акцент на анализ и понятия.

!!! Верни только готовый текст в формате Markdown без пояснений !!!

"""

def make_promt_dop_n(topic, h, discipline):
    return f"""
Ты — опытный преподаватель колледжа, специализирующийся на создании увлекательных и доступных учебных материалов.  
Твоя задача — подготовить адаптированный учебный материал в формате Markdown (.md) для учебно-методического комплекса (УМК), ориентированный на **низко мотивированных студентов**.  

Дано:
- Тема: "{topic}"
- Количество академических часов: {h}
- Дисциплина: "{discipline}"
- Формат вывода: Markdown (.md), с учетом синтаксиса Obsidian.

Цель:  
Создать материал, который поможет студентам:
- повторить и закрепить пройденный материал,  
- заинтересоваться темой через практические примеры,  
- развить уверенность в применении знаний.  

---

## Требования к структуре:

1. **Название занятия** — заголовок первого уровня (`#`).
2. **Цель и задачи занятия** — коротко и понятно (2–4 пункта).
3. **Почему это важно?** — объясни простыми словами, зачем это нужно студенту в реальной жизни или профессии.
4. **Основные понятия и идеи** — 5–7 ключевых терминов с простыми, «человеческими» объяснениями.
5. **Объяснение темы** — структурированный и пошаговый разбор, рассчитанный по времени (пример: *[10 мин]*, *[15 мин]*).
   - Обязательно используй примеры из практики, бытовые аналогии или игровые ситуации.  
   - Если тема связана с программированием — добавь короткие, понятные примеры кода в Markdown-блоках.  
6. **Мини-задания по ходу** — простые интерактивные вопросы или задания с подсказками, чтобы удерживать внимание.  
   - Пример:  
     > Попробуй сам!  
     > Что произойдёт, если заменить значение переменной `x` на 10?  
7. **Итог и выводы** — кратко подведи итоги занятия (3–5 предложений).  
8. **Проверь себя** — 5 простых вопросов для самопроверки (разного типа: тестовые, открытые, на понимание).
9. **Полезные источники и ссылки** — список 3–5 доступных, проверенных и интересных ресурсов, например:
   - Статьи или курсы с понятными объяснениями (YouTube, Stepik, Codewars, W3Schools, MDN и т.п.)
   - Образовательные платформы (например, https://developer.mozilla.org/, https://stepik.org/, https://www.w3schools.com/)
   - Учебники или официальная документация.

---

## Особенности генерации:

- Пиши **дружелюбным и мотивирующим тоном**, избегай излишне академического языка.  
- Используй короткие абзацы и подзаголовки, чтобы материал выглядел легко читаемым.  
- Обязательно добавляй небольшие примеры, аналогии или мини-игровые ситуации.  
- Объём должен соответствовать времени:  
  - 1 академический час ≈ 45 минут,  
  - 2 академических часа ≈ 90 минут.  
- Весь текст должен быть в корректном синтаксисе Markdown для Obsidian.  
- Не используй смайлики, подчеркивания и декоративные символы (---).  
- Все внешние ресурсы указывать в виде обычных Markdown-ссылок.

---

!!! Верни **только готовый текст** в формате Markdown без пояснений, комментариев и служебных фраз !!!
"""

def make_promt_dop_v(topic, h, discipline):
    return f"""
Ты — опытный преподаватель колледжа и методист.  
Твоя задача — подготовить **глубокий, аналитический и вдохновляющий конспект лекции** для учебно-методического комплекса (УМК), ориентированный на **высокомотивированных студентов**.

Дано:
- Тема: "{topic}"
- Количество академических часов: {h}
- Дисциплина: "{discipline}"
- Формат вывода: Markdown (.md), совместимый с Obsidian.
- Целевая аудитория: студенты, стремящиеся к углублённому изучению дисциплины и саморазвитию в IT-сфере.
- Цель лекции: расширить границы базовых знаний, раскрыть потенциал темы, связать теорию с реальной профессиональной практикой, стимулировать исследовательскую и проектную деятельность.

Требования к структуре:
1. # {topic}  
   Краткое введение в тему и её значимость для будущей профессии.
2. ## Цели и задачи  
   Опиши 3–5 конкретных целей, включая развитие аналитического и исследовательского мышления.
3. ## Ключевые понятия  
   5–10 ключевых терминов с **расширенными определениями** (не просто "что это", но и "зачем это нужно").
4. ## Основное содержание  
   Разбей материал на смысловые разделы 2–3 уровня.  
   - Для каждого раздела укажи примерное время изучения (в минутах).  
   - Включай не только теорию, но и размышления о применении, сравнительный анализ технологий, примеры из индустрии.  
   - Добавь **“исследовательские вставки”** — небольшие блоки с вопросами для самостоятельного анализа или мини-экспериментов.
5. ## Примеры и иллюстрации  
   Приведи **неочевидные примеры**, реальные кейсы, демонстрации кода, схемы, результаты экспериментов.  
   Если уместно — оформи код в Markdown-блоках.
6. ## Проектные идеи  
   2–3 предложения, как применить знания в мини-проекте, исследовании или стартап-идее.
7. ## Выводы  
   Краткое резюме ключевых идей и возможных направлений дальнейшего изучения.
8. ## Вопросы для самопроверки  
   5–10 глубоких вопросов, требующих анализа и аргументации (не просто "что это", а "почему именно так").
9. ## Рекомендуемая литература и ресурсы  
   - 3–5 качественных источников: книги, стандарты, академические публикации, открытые курсы (ссылки разрешены).  
   Примеры формата:  
     - [Clean Code — Robert C. Martin](https://www.oreilly.com/library/view/clean-code/9780136083238/)  
     - [Design Patterns — Gamma et al.](https://refactoring.guru/design-patterns)  
     - [MDN Web Docs](https://developer.mozilla.org/)  
     - [Kaggle Learn](https://www.kaggle.com/learn)  
     - [W3C Standards](https://www.w3.org/)

Особенности генерации:
- Стиль изложения — профессионально-академический, с элементами исследовательского подхода.  
- Материал рассчитан на самостоятельное освоение и требует активного участия обучающегося.  
- Код и примеры должны быть релевантны теме и современным практикам.  
- Для 1 академического часа — 45 минут контента.  
- Не использовать смайлы, подчёркивания и декоративные символы.  
- Все заголовки и форматирование должны строго соответствовать синтаксису Markdown (для Obsidian).  

!!! Верни только готовый текст в формате Markdown без пояснений !!!
"""

def make_promt_plan(topic, h, discipline, t):
    return f"""
Ты — опытный преподаватель колледжа.  
Твоя задача — подготовить краткий, структурированный **план занятия** для учебно-методического комплекса (УМК).  

Дано:  
- Тема: "{topic}"  
- Количество академических часов: {h}  
- Дисциплина: "{discipline}"
- Тип занятия: {t}  
- Целевая аудитория: студенты колледжа, изучающие дисциплину "{discipline}"  
- Формат вывода: Markdown (.md), с учетом синтаксиса Obsidian.  

Требования к структуре:  
1. **Название занятия** — заголовок первого уровня.  
2. **Цель занятия** — 1–2 чётких формулировки.  
3. **Задачи занятия** — 3–5 пунктов.  
4. **План занятия** — структурированный список этапов с указанием времени (в минутах) на каждый пункт.  
   - Общая продолжительность занятия: 45 минут × количество академических часов ({h}).  
   - Каждый пункт должен иметь вид:  
     `- [Название этапа] — [время в минутах]`  
   - Пример структуры:  
     - Организационный момент — 5 мин  
     - Актуализация знаний — 10 мин  
     - Изучение нового материала — 20 мин  
     - Закрепление — 15 мин  
     - Итог занятия — 5 мин  
5. **Содержание этапов** — краткое описание (2–4 предложения) для каждого пункта из плана.  
6. **Оборудование и материалы** — список используемых средств (ПК, проектор, IDE, учебники и т.д.).  
7. **Контроль и оценивание** — формы проверки знаний (вопросы, тест, выполнение задания и т.д.).  
8. **Домашнее задание** — если уместно, 1–2 задания на закрепление.  

Особенности генерации:  
- Стиль изложения — академичный и лаконичный, без воды.  
- План должен быть реалистичным и учитывать логическую последовательность этапов.  
- Не использовать смайлики, декоративные символы или горизонтальные линии (---).  
- Время каждого этапа должно суммироваться в общую продолжительность (45 минут × {h}).  
- Вывод — **только готовый текст в формате Markdown**, без пояснений и комментариев.  

"""

def ask_ai(key, promt):
   client = Groq(
      api_key=key,
      default_headers={
         "Groq-Model-Version": "latest"
      }
   )
   completion = client.chat.completions.create(
      model="groq/compound",
      messages=[
         {
         "role": "user",
         "content": promt
         }
      ],
      temperature=0.8,
      max_completion_tokens=8192,
      top_p=1,
      stream=True,
      stop=None,
      compound_custom={"tools":{"enabled_tools":["web_search","visit_website"]}}
   )

   res = ""

   for chunk in completion:
      print(chunk.choices[0].delta.content or "", end="")
      res + str(chunk.choices[0].delta.content or "")

   print()
   res + "\n"

   return res